# Dead Letter Queue (DLT)

`DLT`는 발행된 메시지가 정상적으로 처리 되지않았을 경우 해당 메시지를 보관하는 토픽이다.

메시지 처리를 실패하였을때 재발행시켜 처리하게 되면 해당 메시지가 무한정으로 재발행되는 상황이 발생할 수 있다.     
이러한 상황을 방지하기 위해 DLT를 사용한다.

## 효과적으로 처리하는 방법

- 네트워크, 일시적 장애   

네트워크 이슈로 인해 메시지가 처리되지 않았을 경우 해당 메시지를 재발행하여 처리   
BackOff를 두어 재발행 시간을 조절   
DLT에 발행 하기 전 재발행 횟수를 제한하여 무한 재발행을 방지

- 비즈니스 로직 오류

해당 메시지로 실행된 로직에서 발생한 오류가 의도된 오류인지 구분하여야 한다.   
의도된 오류라면 DLT에 발행하지 않고 실패응답 전송   
의도되지 않은 오류라면 로그를 남기고 DLT에 발행하여 확인   

## 안정적으로 처리

- DLT 분리

과도한 DLT 발행으로 인한 장애를 방지하기 위해 DLT 처리 서비스를 별도로 구성하여 처리   

- DLT 처리

DLT에 발행된 메시지를 처리하는 서비스는 최대한 단순하게 구성하여 안정적으로 처리    
또한 메시지의 중요도를 고려하여 처리 우선순위를 정하여 처리

- DLT 모니터링

DLT에 발행된 메시지를 모니터링하여 장애 발생시 빠르게 대응